<!DOCTYPE html>
<html>
  <head>
    <title>Redirect to RFilm</title>
    <script>
      window.onload = function () {
        // Trích xuất phần hash của URL (sau dấu #)
        const urlHash = window.location.hash.substring(1); // Lấy phần sau dấu #
        
        // Tách các tham số từ hash
        const urlParams = new URLSearchParams(urlHash);
        const accessToken = urlParams.get("access_token");
        
        let deepLink = "rfilm://login";

        if (accessToken) {
          deepLink += `?access_token=${encodeURIComponent(accessToken)}`;
        } else { 
          deepLink += "?access_token=";
        }

        console.log("Redirecting to:", deepLink);
        window.location.href = deepLink;
      };
    </script>
  </head>
  <body>
    <p>Nếu bạn không được chuyển hướng, hãy nhấn 
      <a id="manualLink" href="#">tại đây</a>.
    </p>
    <script>
      // Tương tự như trên, tạo một link thủ công
      const urlHash = window.location.hash.substring(1); // Lấy phần sau dấu #
      const urlParams = new URLSearchParams(urlHash);
      const accessToken = urlParams.get("access_token");

      let deepLink = "rfilm://login";

      if (accessToken) {
        deepLink += `?access_token=${encodeURIComponent(accessToken)}`;
      } else { 
        deepLink += "?access_token=";
      }

      document.getElementById("manualLink").href = deepLink;
      console.log("Manual link:", deepLink);
    </script>
  </body>
</html>
